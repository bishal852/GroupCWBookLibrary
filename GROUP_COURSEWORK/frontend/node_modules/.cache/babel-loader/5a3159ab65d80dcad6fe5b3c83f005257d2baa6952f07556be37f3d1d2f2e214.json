{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\nikku\\\\Desktop\\\\GROUP_COURSEWORK\\\\frontend\\\\src\\\\components\\\\ReviewsList.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { reviewService } from \"../services/reviewService\";\nimport ReviewItem from \"./ReviewItem\";\nimport ReviewForm from \"./ReviewForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ReviewsList({\n  bookId\n}) {\n  _s();\n  const [reviews, setReviews] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [canReview, setCanReview] = useState(false);\n  const [hasPurchased, setHasPurchased] = useState(false);\n  const [hasReviewed, setHasReviewed] = useState(false);\n  const [showReviewForm, setShowReviewForm] = useState(false);\n  useEffect(() => {\n    fetchReviews();\n    checkCanReview();\n  }, [bookId]);\n  const fetchReviews = async () => {\n    setLoading(true);\n    try {\n      const data = await reviewService.getBookReviews(bookId);\n      setReviews(data);\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const checkCanReview = async () => {\n    try {\n      const {\n        canReview: canReviewBook,\n        hasPurchased: hasUserPurchased,\n        hasReviewed: hasUserReviewed\n      } = await reviewService.canReviewBook(bookId);\n      setCanReview(canReviewBook);\n      setHasPurchased(hasUserPurchased);\n      setHasReviewed(hasUserReviewed);\n    } catch (error) {\n      console.error(\"Error checking if user can review:\", error);\n    }\n  };\n  const handleReviewSubmitted = () => {\n    fetchReviews();\n    checkCanReview();\n    setShowReviewForm(false);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"Loading reviews...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"reviews-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"reviews-title\",\n      children: \"Customer Reviews\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reviews-summary\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reviews-count\",\n        children: [reviews.length, \" \", reviews.length === 1 ? \"review\" : \"reviews\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), canReview && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: () => setShowReviewForm(true),\n        children: \"Write a Review\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this), !canReview && hasPurchased && hasReviewed && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"review-status\",\n        children: \"You have already reviewed this book\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this), !canReview && !hasPurchased && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"review-status\",\n        children: \"Only verified buyers can review this book\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 41\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), showReviewForm && canReview && /*#__PURE__*/_jsxDEV(ReviewForm, {\n      bookId: bookId,\n      onReviewSubmitted: handleReviewSubmitted\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 39\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reviews-list\",\n      children: reviews.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"no-reviews\",\n        children: \"No reviews yet. Be the first to review this book!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this) : reviews.map(review => /*#__PURE__*/_jsxDEV(ReviewItem, {\n        review: review,\n        onReviewUpdated: handleReviewSubmitted\n      }, review.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n}\n_s(ReviewsList, \"xOBosa/x6nGjIe8FSJZ8qP4mt88=\");\n_c = ReviewsList;\nexport default ReviewsList;\nvar _c;\n$RefreshReg$(_c, \"ReviewsList\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","useState","useEffect","reviewService","ReviewItem","ReviewForm","jsxDEV","_jsxDEV","ReviewsList","bookId","reviews","setReviews","loading","setLoading","error","setError","canReview","setCanReview","hasPurchased","setHasPurchased","hasReviewed","setHasReviewed","showReviewForm","setShowReviewForm","fetchReviews","checkCanReview","data","getBookReviews","message","canReviewBook","hasUserPurchased","hasUserReviewed","console","handleReviewSubmitted","className","children","fileName","lineNumber","columnNumber","length","onClick","onReviewSubmitted","map","review","onReviewUpdated","id","_c","$RefreshReg$"],"sources":["C:/Users/nikku/Desktop/GROUP_COURSEWORK/frontend/src/components/ReviewsList.jsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { reviewService } from \"../services/reviewService\"\nimport ReviewItem from \"./ReviewItem\"\nimport ReviewForm from \"./ReviewForm\"\n\nfunction ReviewsList({ bookId }) {\n  const [reviews, setReviews] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(\"\")\n  const [canReview, setCanReview] = useState(false)\n  const [hasPurchased, setHasPurchased] = useState(false)\n  const [hasReviewed, setHasReviewed] = useState(false)\n  const [showReviewForm, setShowReviewForm] = useState(false)\n\n  useEffect(() => {\n    fetchReviews()\n    checkCanReview()\n  }, [bookId])\n\n  const fetchReviews = async () => {\n    setLoading(true)\n    try {\n      const data = await reviewService.getBookReviews(bookId)\n      setReviews(data)\n    } catch (error) {\n      setError(error.message)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const checkCanReview = async () => {\n    try {\n      const {\n        canReview: canReviewBook,\n        hasPurchased: hasUserPurchased,\n        hasReviewed: hasUserReviewed,\n      } = await reviewService.canReviewBook(bookId)\n      setCanReview(canReviewBook)\n      setHasPurchased(hasUserPurchased)\n      setHasReviewed(hasUserReviewed)\n    } catch (error) {\n      console.error(\"Error checking if user can review:\", error)\n    }\n  }\n\n  const handleReviewSubmitted = () => {\n    fetchReviews()\n    checkCanReview()\n    setShowReviewForm(false)\n  }\n\n  if (loading) {\n    return <div className=\"loading\">Loading reviews...</div>\n  }\n\n  return (\n    <div className=\"reviews-section\">\n      <h2 className=\"reviews-title\">Customer Reviews</h2>\n\n      {error && <div className=\"alert alert-danger\">{error}</div>}\n\n      <div className=\"reviews-summary\">\n        <div className=\"reviews-count\">\n          {reviews.length} {reviews.length === 1 ? \"review\" : \"reviews\"}\n        </div>\n        {canReview && (\n          <button className=\"btn btn-primary\" onClick={() => setShowReviewForm(true)}>\n            Write a Review\n          </button>\n        )}\n        {!canReview && hasPurchased && hasReviewed && (\n          <div className=\"review-status\">You have already reviewed this book</div>\n        )}\n        {!canReview && !hasPurchased && <div className=\"review-status\">Only verified buyers can review this book</div>}\n      </div>\n\n      {showReviewForm && canReview && <ReviewForm bookId={bookId} onReviewSubmitted={handleReviewSubmitted} />}\n\n      <div className=\"reviews-list\">\n        {reviews.length === 0 ? (\n          <div className=\"no-reviews\">No reviews yet. Be the first to review this book!</div>\n        ) : (\n          reviews.map((review) => (\n            <ReviewItem key={review.id} review={review} onReviewUpdated={handleReviewSubmitted} />\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default ReviewsList\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}